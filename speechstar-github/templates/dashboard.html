{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">
            <i class="fas fa-chart-line me-2"></i>
            üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–µ—á–µ–≤–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è
        </h1>
        
        <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>
            <strong>–°–∏—Å—Ç–µ–º–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:</strong> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –±–æ—Ç–æ–º –≤ –ø–∞–º—è—Ç–∏. –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ÆKassa –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ PostgreSQL.
        </div>
    </div>
</div>

<!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div class="row mb-4">
    <div class="col-md-2">
        <div class="card bg-primary text-white">
            <div class="card-body text-center">
                <h3>{{ stats.get('total_users', 0) }}</h3>
                <p class="mb-0"><i class="fas fa-users"></i> –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-2">
        <div class="card bg-warning text-dark">
            <div class="card-body text-center">
                <h3>{{ stats.get('trial_users', 0) }}</h3>
                <p class="mb-0"><i class="fas fa-clock"></i> –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-2">
        <div class="card bg-success text-white">
            <div class="card-body text-center">
                <h3>{{ stats.get('monthly_subscribers', 0) }}</h3>
                <p class="mb-0"><i class="fas fa-calendar-alt"></i> –ú–µ—Å—è—á–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-2">
        <div class="card bg-info text-white">
            <div class="card-body text-center">
                <h3>{{ stats.get('lifetime_subscribers', 0) }}</h3>
                <p class="mb-0"><i class="fas fa-crown"></i> –ù–∞–≤—Å–µ–≥–¥–∞</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-2">
        <div class="card bg-secondary text-white">
            <div class="card-body text-center">
                <h3>{{ stats.get('promocode_users', 0) }}</h3>
                <p class="mb-0"><i class="fas fa-ticket-alt"></i> –ü–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-2">
        <div class="card bg-dark text-white">
            <div class="card-body text-center">
                <h3>{{ stats.get('total_payments', 0) }}</h3>
                <p class="mb-0"><i class="fas fa-credit-card"></i> –í—Å–µ–≥–æ –ø–ª–∞—Ç–µ–∂–µ–π</p>
            </div>
        </div>
    </div>
</div>

<!-- –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã -->
<div class="row mb-4">
    <div class="col-md-6">
        <div class="card border-warning">
            <div class="card-body text-center">
                <h5 class="text-warning"><i class="fas fa-exclamation-triangle"></i> –ü–ª–∞—Ç–µ–∂–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã</h5>
                <p class="mb-0">–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ÆKassa –¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π</p>
                <small class="text-muted">–°–º. YOOKASSA_SETUP.md</small>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card border-info">
            <div class="card-body text-center">
                <h5 class="text-info"><i class="fas fa-database"></i> –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º</h5>
                <p class="mb-0">–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –±–æ—Ç–∞</p>
                <small class="text-muted">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –≥–æ—Ç–æ–≤–æ</small>
            </div>
        </div>
    </div>
</div>

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-baby me-2"></i>
                    –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    {% for age_group, data in task_stats.items() %}
                    <div class="col-md-6 mb-3">
                        <div class="card border-primary">
                            <div class="card-header bg-primary text-white">
                                <h6 class="mb-0">üë∂ {{ age_group }}</h6>
                            </div>
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-4">
                                        <h4 class="text-primary">{{ data.total }}</h4>
                                        <small>–í—Å–µ–≥–æ –∑–∞–¥–∞–Ω–∏–π</small>
                                    </div>
                                    <div class="col-4">
                                        <h4 class="text-success">{{ data.with_images }}</h4>
                                        <small>–° –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</small>
                                    </div>
                                    <div class="col-4">
                                        <h4 class="text-info">{{ data.with_videos }}</h4>
                                        <small>–° –≤–∏–¥–µ–æ</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-cogs me-2"></i>
                    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-2">
                        <a href="{{ url_for('tasks_list') }}" class="btn btn-primary btn-lg w-100">
                            <i class="fas fa-list me-2"></i>
                            –í—Å–µ –∑–∞–¥–∞–Ω–∏—è
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                        <a href="{{ url_for('new_task') }}" class="btn btn-success btn-lg w-100">
                            <i class="fas fa-plus me-2"></i>
                            –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                        <a href="{{ url_for('users') }}" class="btn btn-info btn-lg w-100">
                            <i class="fas fa-users me-2"></i>
                            –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                        <a href="{{ url_for('analytics') }}" class="btn btn-warning btn-lg w-100">
                            <i class="fas fa-chart-bar me-2"></i>
                            –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ -->
<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-robot me-2"></i>
                    –°—Ç–∞—Ç—É—Å Telegram –±–æ—Ç–∞
                </h6>
            </div>
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <span>@SpeechStarBot</span>
                    <span class="badge bg-success">–ê–∫—Ç–∏–≤–µ–Ω</span>
                </div>
                <small class="text-muted">–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã: 9-14 –º–µ—Å, 15-19 –º–µ—Å</small>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-ticket-alt me-2"></i>
                    –ü—Ä–æ–º–æ–∫–æ–¥—ã
                </h6>
            </div>
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <span>–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤</span>
                    <span class="badge bg-info">100</span>
                </div>
                <small class="text-muted">–î–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞–≤—Å–µ–≥–¥–∞</small>
            </div>
        </div>
    </div>
</div>

{% endblock %}